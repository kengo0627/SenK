# SenK

SenKは高性能線形ソルバ用のC++ライブラリです。基本的な機能のみを備えたヘッダーオンリーライブラリで容易に導入できます。

主に、CSR行列格納形式による疎行列連立一次方程式ソルバを提供します。

## 必要条件

コンパイラやOS環境へ依存しないような実装を心がけていますが、macOS、Ubuntu、CentOS以外での動作は未確認です。C++17で開発を行なっているので、C++17に対応したコンパイラを使用してください。C++標準ライブラリのみを利用しているので、他ライブラリ等のインストールは不要です。

## 使い方

SenKはヘッダーオンリーライブラリなので、事前ビルドは必要ありません。ソースファイルで`senk.hpp`をインクルードし、コンパイル時にインクルードパスを指定するだけで利用できます。

```c++
#include "senk.hpp"
int main(int argc, char **argv) {
  //Blhablhablha
}
```

```she
g++ -O3 -std=c++17 -fopenmp main.cpp -I(PATH to SenK)/include -o a.out
```

## 内容

| ヘッダーファイル | 内容                                                 |
| ---------------- | ---------------------------------------------------- |
| `senk.hpp`       | 最上位のヘッダーファイル、利用にインクルードされる。 |
| `senk_blas1.hpp` | BLAS Level 1に似た関数を定義している。               |
| `senk_blas2.hpp` | BLAS Level 2に似た関数を定義している。               |
|                  |                                                      |
|                  |                                                      |
|                  |                                                      |
|                  |                                                      |
|                  |                                                      |
|                  |                                                      |

## 実装状況

- 線形ソルバ
  - 実装済み：GMRES(m)、GCR(m)、BiCGStab法
  - 実装予定：CG法
- 前処理
  - 実装済み：ILU(0)、ILU(p)、ILUB前処理
  - 実装予定：IC(0)、IC(p)前処理（対称性を利用した実装）

## ILUB（分解）前処理

ILUB前処理はILU分解に基づく前処理手法の一つです。ILU前処理ではILU分解中のフィルインの制御が重要な役割を担います。フィルインによる計算量の増加と求解性能の向上はトレードオフの関係にあるため、適切にフィルインを制御する必要があります。ILUB前処理では、ILU分解中にある（縦長）ブロック構造に基づいてフィルインを制御します。それにより、前処理過程での前進後退代入計算時にブロック内部の計算にSIMD演算を効果的に利用できます。つまり、計算量の増加の影響をSIMD演算により緩和できるため、求解性能の向上の利点が現れやすくなります。

詳しくは、鈴木他, ブロックに基づくfill-in選択手法を利用したILU-GMRESソルバ, 情報処理学会研究報告, 2020-HPC-177(20):1–7を参照ください。原著論文は査読中です。
